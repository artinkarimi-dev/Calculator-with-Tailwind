<!DOCTYPE html>
<html class="" lang="fa" dir="rtl">

<head>
  <meta charset="UTF-8">
  <meta name="description" content="Free Web tutorials">
  <meta name="keywords" content="HTML, CSS, JavaScript">
  <meta name="author" content="John Doe">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Tailwind (Browser CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

  <style>
    #themeToggle {
      position: absolute;
      inset: 0;
      width: 0;
      height: 0;
      opacity: 0;
      pointer-events: none;
    }


    #root-light {
      display: block;
    }

    #root-dark {
      display: none;
    }


    #themeToggle:checked~#root-light {
      display: none;
    }

    #themeToggle:checked~#root-dark {
      display: block;
    }


    #root-light,
    #root-dark {
      transition: opacity .3s ease;
    }
  </style>
</head>

<body>

  <input id="themeToggle" type="checkbox" />


  <div id="root-light">
    <header>

      <label for="themeToggle" id="btnDark-light"
        class="flex items-center justify-center bg-cyan-200 h-14 w-14 rounded-full mx-auto mt-5 shadow-xl hover:cursor-pointer hover:bg-cyan-400 transition duration-300 ease-in-out">
        <p><i class="fa-solid fa-moon fa-2x"></i></p>
      </label>
    </header>

    <main class="mt-6">
      <div class="w-75 h-100 border-1 border-cyan-500 m-auto rounded-lg sm:w-100 md:w-130 lg:w-150 xl:w-175 2xl:w-200">
        <p class="text-right text-5xl font-mono pr-6 pt-6">0</p>
        <div class="mt-7 px-2 text-center mx-auto">
          <div class="flex justify-center gap-1 ">
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out bg-neutral-100">%</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out bg-neutral-100">CE</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out bg-neutral-100">C</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out bg-neutral-100"><i
                class="fa-solid fa-delete-left"></i></button>
          </div>

          <div class="flex justify-center gap-1 mt-1">
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out bg-neutral-100">1/x</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out bg-neutral-100">x²</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out bg-neutral-100">²√x</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out bg-neutral-100">÷</button>
          </div>

          <div class="flex justify-center gap-1 mt-1">
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out">7</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out">8</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out">9</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out bg-neutral-100">x</button>
          </div>

          <div class="flex justify-center gap-1 mt-1">
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out">4</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out">5</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out">6</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out bg-neutral-100">-</button>
          </div>

          <div class="flex justify-center gap-1 mt-1">
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out">1</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out">2</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out">3</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out bg-neutral-100">+</button>
          </div>

          <div class="flex justify-center gap-1 mt-1">
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out">+/-</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out">0</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out">.</button>
            <button
              class="w-1/1 h-11.2 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out bg-cyan-200 text-xl font-bold">=</button>
          </div>
        </div>
      </div>
    </main>
  </div>


  <div id="root-dark" class="bg-slate-900 min-h-screen text-white">
    <header>

      <label for="themeToggle" id="btnDark-dark"
        class="flex items-center justify-center bg-slate-900 h-14 w-14 rounded-full mx-auto mt-5 shadow-xl hover:cursor-pointer hover:bg-slate-800 transition duration-300 ease-in-out border border-slate-700">
        <p><i class="fa-solid fa-sun fa-2x text-white"></i></p>
      </label>
    </header>

    <main class="mt-6">
      <div class="w-75 h-100 m-auto rounded-lg sm:w-100 md:w-130 lg:w-150 xl:w-175 2xl:w-200 border-1 border-cyan-500">
        <p class="text-right text-5xl font-mono pr-6 pt-6 text-white">0</p>

        <div class="mt-7 px-2 text-center mx-auto">
          <div class="flex justify-center gap-1">
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-700 text-slate-100 hover:border-emerald-400">%</button>
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-700 text-slate-100 hover:border-emerald-400">CE</button>
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-700 text-slate-100 hover:border-emerald-400">C</button>
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-700 text-slate-100 hover:border-emerald-400"><i
                class="fa-solid fa-delete-left"></i></button>
          </div>

          <div class="flex justify-center gap-1 mt-1">
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-700 text-slate-100 hover:border-emerald-400">1/x</button>
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-700 text-slate-100 hover:border-emerald-400">x²</button>
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-700 text-slate-100 hover:border-emerald-400">²√x</button>
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-700 text-slate-100 hover:border-emerald-400">÷</button>
          </div>

          <div class="flex justify-center gap-1 mt-1">
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-800 text-slate-100 hover:border-emerald-400">7</button>
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-800 text-slate-100 hover:border-emerald-400">8</button>
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-800 text-slate-100 hover:border-emerald-400">9</button>
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-700 text-slate-100 hover:border-emerald-400">x</button>
          </div>

          <div class="flex justify-center gap-1 mt-1">
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-800 text-slate-100 hover:border-emerald-400">4</button>
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-800 text-slate-100 hover:border-emerald-400">5</button>
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-800 text-slate-100 hover:border-emerald-400">6</button>
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-700 text-slate-100 hover:border-emerald-400">-</button>
          </div>

          <div class="flex justify-center gap-1 mt-1">
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out">1</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out">2</button>
            <button
              class="w-1/1 py-2.5 border-1 border-gray-200 rounded-md shadow-lg cursor-pointer hover:border-emerald-800 transition duration-300 ease-in-out">3</button>
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-700 text-slate-100 hover:border-emerald-400">+</button>
          </div>

          <div class="flex justify-center gap-1 mt-1">
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-800 text-slate-100 hover:border-emerald-400">+/-</button>
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-800 text-slate-100 hover:border-emerald-400">0</button>
            <button
              class="w-1/1 py-2.5 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-800 text-slate-100 hover:border-emerald-400">.</button>
            <button
              class="w-1/1 h-11.2 rounded-md shadow-lg cursor-pointer transition duration-300 ease-in-out border-1 border-slate-700 bg-slate-900 text-xl font-bold hover:border-emerald-400">=</button>
          </div>
        </div>
      </div>
    </main>
  </div>
  <script>

    (function () {
      const cb = document.getElementById('themeToggle');

      const saved = localStorage.getItem('theme');
      if (saved === 'dark') cb.checked = true;
      else if (saved === 'light') cb.checked = false;


      cb.addEventListener('change', () => {
        localStorage.setItem('theme', cb.checked ? 'dark' : 'light');
      });
    })();


    (function () {

      const displays = Array.from(document.querySelectorAll('#root-light main p, #root-dark main p'));
      const allButtons = Array.from(document.querySelectorAll('#root-light main button, #root-dark main button'));


      let current = '0';
      let previous = null;
      let operator = null;
      let justEvaluated = false;


      const MAX_LEN = 14;

      function formatNumber(str) {

        if (str.length > 50) str = str.slice(0, 50);

        if (str !== '0' && !str.startsWith('0.') && !str.startsWith('-0.')) {

          str = str.replace(/^(-?)0+(\d)/, '$1$2');
        }

        if (str.replace('-', '').length > MAX_LEN) {
          const num = Number(str);
          if (Number.isFinite(num)) return num.toExponential(6);
        }
        return str;
      }

      function updateDisplay() {
        const text = formatNumber(current);
        for (const d of displays) d.textContent = text;
      }

      function setCurrent(val) {
        current = String(val);
        updateDisplay();
      }

      function clearAll() {
        current = '0';
        previous = null;
        operator = null;
        justEvaluated = false;
        updateDisplay();
      }

      function clearEntry() {
        current = '0';
        justEvaluated = false;
        updateDisplay();
      }

      function backspace() {
        if (justEvaluated) {
          clearEntry();
          return;
        }
        if (current.length <= 1 || (current.length === 2 && current.startsWith('-'))) {
          current = '0';
        } else {
          current = current.slice(0, -1);
        }
        updateDisplay();
      }

      function inputDigit(d) {
        if (justEvaluated) {
          current = d;
          justEvaluated = false;
        } else {
          if (current === '0') current = d;
          else current += d;
        }
        updateDisplay();
      }

      function inputDot() {
        if (justEvaluated) {
          current = '0.';
          justEvaluated = false;
          updateDisplay();
          return;
        }
        if (!current.includes('.')) {
          current += '.';
          updateDisplay();
        }
      }

      function toggleSign() {
        if (current === '0') return;
        current = current.startsWith('-') ? current.slice(1) : ('-' + current);
        updateDisplay();
      }

      function setOperator(op) {

        if (operator && previous !== null && !justEvaluated) {
          equals();
        }
        previous = Number(current);
        operator = op;
        justEvaluated = false;
        current = '0';
        updateDisplay();
      }

      function doUnary(fn) {
        const x = Number(current);
        if (!Number.isFinite(x)) return;

        let res;
        switch (fn) {
          case 'inv':
            if (x === 0) { setCurrent('Cannot divide by 0'); justEvaluated = true; return; }
            res = 1 / x; break;
          case 'sqr':
            res = x * x; break;
          case 'sqrt':
            if (x < 0) { setCurrent('Invalid input'); justEvaluated = true; return; }
            res = Math.sqrt(x); break;
          case 'percent':

            if (previous !== null && operator) {
              res = previous * (x / 100);
            } else {
              res = x / 100;
            }
            break;
          default:
            return;
        }
        setCurrent(String(res));
        justEvaluated = true;
      }

      function equals() {
        if (operator === null || previous === null) {
          justEvaluated = true;
          return;
        }
        const a = previous;
        const b = Number(current);
        let res;
        switch (operator) {
          case '+': res = a + b; break;
          case '-': res = a - b; break;
          case '*': res = a * b; break;
          case '/':
            if (b === 0) { setCurrent('Cannot divide by 0'); previous = null; operator = null; justEvaluated = true; return; }
            res = a / b; break;
          default: return;
        }
        setCurrent(String(res));
        previous = null;
        operator = null;
        justEvaluated = true;
      }


      function handleButton(btn) {
        const hasBackIcon = !!btn.querySelector('.fa-delete-left');
        if (hasBackIcon) { backspace(); return; }

        const text = (btn.textContent || '').trim();

        if (/^\d$/.test(text)) {
          inputDigit(text);
          return;
        }

        switch (text) {
          case '.': inputDot(); break;
          case '+/-': toggleSign(); break;
          case 'C': clearAll(); break;
          case 'CE': clearEntry(); break;
          case '=': equals(); break;
          case '+': setOperator('+'); break;
          case '-': setOperator('-'); break;
          case 'x': setOperator('*'); break;
          case '÷': setOperator('/'); break;
          case '%': doUnary('percent'); break;
          case '1/x': doUnary('inv'); break;
          case 'x²': doUnary('sqr'); break;
          case '²√x': doUnary('sqrt'); break;
          default:

            break;
        }
      }


      allButtons.forEach(btn => {
        btn.addEventListener('click', () => handleButton(btn));
      });


      window.addEventListener('keydown', (e) => {
        const k = e.key;
        if (/\d/.test(k)) { inputDigit(k); return; }
        switch (k) {
          case '.': case ',': inputDot(); break;
          case '+': setOperator('+'); break;
          case '-': setOperator('-'); break;
          case '*': setOperator('*'); break;
          case '/': setOperator('/'); break;
          case 'Enter': case '=': equals(); break;
          case 'Backspace': backspace(); break;
          case 'Escape': case 'Delete': clearEntry(); break;
          case '%': doUnary('percent'); break;
        }
      });


      updateDisplay();
    })();
  </script>


</body>

</html>